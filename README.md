# Ora2Pg support scripts
---
The `Python` scripts helps with automation executing the SQL-output code, generated by `Ora2Pg`, and writes an error log for easier debugging. Also, it helps to delete unnecessary lines from SQL-file.

#### Requirements
* Python 3

#### Preparations
You can specify your structure, but by default, script expects this structure.

![Folders](https://raw.githubusercontent.com/nurgalive/ora2pg_scripts/master/materials/1.png)

SQL-files for the executing need to put in the `check` folder.
After execution, files executed without error will be moved to the `ready` folder, and the name of the file will be added the sequence number `query1.sql` -> `1_query1.sql`
The files, which executed with errors will be moved to the `error` folder.
All error will be written in the `log-file`.

#### Scripts description
There are 4 scripts:
* `delete_lines.py` helps to delete these lines:
```
-- Generated by Ora2Pg, the Oracle database Schema converter, version 18.2
-- Copyright 2000-2017 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=127.0.0.1;sid=oracle_db;port=1521

SET client_encoding TO 'UTF8';

\set ON_ERROR_STOP ON

SET check_function_bodies = false;
```
* `test_table_create.py` used for creating a test table in PostgreSQL and check connection and settings
* `sql_checker_test.py` can check the settings of the script before starting with `SELECT` statement
For the test, you need to create any simple query and put it to `check` folder.
According to the created test table `Products`, you can create for example this query:
```sql
SELECT * FROM Products;
```

```sql
SELECT * FROM Products WHERE id=1234;
```
* `sql_checker.py` Main script. Tries to execute the SQL code from the `check` folder. If it gets errors it moves to the `error` folder, or if it is no errors, the SQL file moves to the `ready` folder. All errors written in log-file named after the script starting time.


